---
title: 清北集训Day5 后缀自动机
date: 2017-05-02 15:16:06
tags: [清北集训,后缀自动机]
---

# 清北集训Day5 后缀自动机

<!--more-->

后缀自动机:可以接受所有后缀的自动机.

考虑串"abcabd",这时候进来字符"b"和"ab",实际上所匹配的位置是等价的,都只能匹配到{2,5}.
当注意到这个问题:影响一个状态的是它能匹配到的位置,就要考虑如何去除冗余的东西.

考虑另一个串"eabcfabd",这时候进来字符"b"和"ab",实际上所匹配的位置是等价的,都只能匹配到{3,7}.
但如果进来的是"eab",只能匹配到{3},而如果进来的是"fab",只能匹配到{7}.
所以后缀自动机上的每一个状态,都可以代表了它能匹配到的若干的位置,就记这个位置集合为right.本质不同的right集合比较少.
一个节点的right集合的大小,等于这个节点在parent树上子树中的叶子节点的个数.

除了后缀自动机上的转移边,还有另一类边叫做parent边,这些边连成一颗parent树.后缀自动机上的某一个节点的right一定是它的parent的right的子集.

可以注意到,后缀自动机每一个节点上的每一个节点都代表一系列长度相同的串.
考虑另一个串"eabcfabdeabc",注意到如果最后一个元素匹配到3"b"这个位置,并且到达后缀自动机right集合为{3,11}的节点,所能够接收的串的长度显然不会太长或太短,它是一个区间.
这个区间的左端点一定是它的parent的右端点+1.

后缀自动机的点数是$O(n)$的,具体来讲是2n的.因为后缀自动机的每一个节点,parent等于这个节点的子节点至少有两个,至多进行$O(n)$次合并就可以合并出一个最大的节点.

终节点一定是若干个right集合大小为1的节点.

## bzoj 2555
实际上就是在动态维护right集合的大小.
会发现在extend的时候,会有断边,加边之类的操作,所以可以用LCT之类的数据结构来维护.